以下为面向下一位同事的交接摘要（Wordbook 单词本首版已完成并可用）

一、目标与范围
- 目标：在 CaptiPrep（Chrome MV3 扩展）中新增“单词本（Wordbook）”功能，提供历史记录/视频收藏/单词收藏三大视图；支持卡片详情预览、收藏、批量选择与导出；保证 YouTube 标题可靠获取用于显示与命名。
- 范围：UI 按钮与新页面、数据存储结构扩展、导出格式增强、标题获取鲁棒性、缩略图自适应与回退。

二、核心实现
- 新入口与页面
  - 在右侧浮动按钮栏新增“单词本”按钮，点击后通过后台脚本打开新标签页。
  - 新页面文件：wordbook.html + wordbook.js（沿用 cc.css 视觉体系）。
- 消息与流程
  - 新增 runtime 消息动作：CC_OPEN_WORDBOOK。
  - ui.js 发送消息 → background.js 接收并用 `chrome.tabs.create` 打开 wordbook.html。
- 数据模型（chrome.storage.local）
  - 每视频：`CCAPTIPREPS:video:{videoId}`，含 title、subtitlesText、candidates/selected/cards、createdAt(YYYY-MM-DD)。
  - 视频收藏：`CCAPTIPREPS:fav:videos`（数组/集合）。
  - 单词收藏（快照）：`CCAPTIPREPS:fav:words`（数组，元素含 {videoId, title, cardIndex, snapshot, savedAt}）。
  - 说明：word 收藏为“快照”，不与后续编辑自动联动。
- UI 与交互
  - Wordbook 左侧栏：历史记录 / 视频收藏 / 单词收藏；右上工具条：全选/删除/收藏/导出；主区卡片按日期分区（createdAt，格式 2025-08-20）。
  - 视频卡片布局：左 7（封面+标题，标题自适应）、右 3（词列表，底部渐隐）。
  - 详情模态：顶部封面、标题居中；下方单词卡片网格；点击卡片进入“大卡片预览（build cards 同款）”，支持上/下一个、编辑、保存、收藏；点击空白处退出。
  - 主流程底部工具栏新增“心形收藏”按钮（位于上一页与编辑之间），复用现有按钮样式与 SVG。
- 导出
  - 批量按视频逐一导出 CSV；文件名采用视频标题（已做非法字符清理）。
  - 新增 examples 合并列：将示例合并为单列（两例之间空行），维持 CSV 引号转义。
- 封面与适配
  - 封面优先 `maxresdefault.jpg`，失败回退 `hqdefault.jpg`；object-fit 自适应裁切。
- YouTube 标题获取鲁棒性
  - 按优先级尝试：meta og:title → twitter:title → itemprop=name → 新版 watch 页 DOM 标题 → 旧版 h1 → document.title 去除 “ - YouTube”。
  - 显式过滤 “(untitled)/untitled” 以避免脏标题。

三、涉及文件
- 新增
  - wordbook.html：Wordbook 页结构（左侧导航/右上工具条/内容区/详情模态）。
  - wordbook.js：数据扫描与渲染、分组、交互、导出、收藏逻辑。
- 修改
  - background.js：添加 CC_OPEN_WORDBOOK 分支，打开新标签页。
  - ui.html：右侧 FAB 加“单词本”按钮；底部工具栏插入心形收藏按钮。
  - ui.js：单词本入口点击处理；收藏快照写入；导出新增 examples 列；首次生成写入 createdAt。
  - content.js：强化 getYouTubeVideoInfo() 的标题提取，避免 “(untitled)”。
  - cc.css：复用现有样式为主（仅若需要补充态样式，已按现有体系对齐）。

四、已完成与待验证
- 已完成
  - 单词本入口与新页面首版交互闭环。
  - 历史记录分区展示，视频/单词收藏视图。
  - 详情模态与大卡片预览（编辑/保存/前后切换/收藏）。
  - 批量选择、删除、收藏、导出（含 examples 合并列、文件名=标题）。
  - createdAt 生成与日期分组；封面回退逻辑；标题鲁棒获取。
- 待验证/可优化
  - 动效与过渡细腻度（“丝滑”程度可微调 easing/时长）。
  - 单词收藏去重与二次点击的“已收藏”提示/切换态。
  - 可访问性（ARIA/键盘操作）。
  - 适配多语言/不同 YouTube 页面布局的全面 QA。
  - 大量视频数据时的性能（可考虑建立索引 key 或分页）。

五、注意事项与风险
- manifest 需确保 web_accessible_resources 覆盖 `assets/*`（若缺失需补充），以便新页面与资源加载。
- 导出文件名清理已处理常见非法字符；如需跨平台严格规则可再补充。
- 单词收藏为“快照”语义是既定设计，如需与源卡片联动需另起版本策略。
- 扫描存储构建目录在数据量变大时可能影响首屏，可考虑缓存索引或懒加载。

六、测试清单（建议走查顺序）
- 生成卡片后检查 `createdAt` 是否写入且 Wordbook 历史按日分组正确。
- 主 UI 心形按钮收藏当前卡片 → Wordbook“单词收藏”能出现该快照并可预览编辑。
- 历史视频卡片右上角收藏/取消；“视频收藏”分栏同步变更。
- 多选 + 导出：逐视频生成 CSV；文件名为视频标题；CSV 包含 examples 合并列且引号转义正确。
- 详情模态：标题居中、封面加载回退、卡片点击进入大卡片预览，支持前后切换/编辑保存，点击空白关闭。
- 标题异常视频不出现 “(untitled)”，document.title 带“ - YouTube”能被正确清理。

七、后续建议
- 搜索/筛选：按标题、单词、日期筛选；收藏排序；分页或虚拟滚动。
- 收藏去重策略：基于 videoId+cardIndex+内容哈希；或提供收藏状态同步。
- 导出增强：支持 Anki/CSV 可选模板、批量合并导出。
- UI 打磨：统一过渡曲线，添加 skeleton/占位，完善空状态。

八、定位与协作要点
- 入口按钮与收藏按钮：ui.html + ui.js
- 新页面与主要逻辑：wordbook.html + wordbook.js
- 后台路由与开页：background.js（消息 CC_OPEN_WORDBOOK）
- 标题与页面信息：content.js（getYouTubeVideoInfo）
- 样式体系：cc.css（复用现有按钮/卡片/模态样式）

